[mysqld]

## General
user                                   = mysql
bind_address                           = 0.0.0.0
port                                   = 3306
basedir                                = /opt/app/mysql57/
datadir                                = /opt/app/mysql57/data
socket                                 = /opt/app/mysql57/var/mysql.sock
pid-file                               = /opt/app/mysql57/var/mysqld.pid
tmpdir                                 = /opt/app/mysql57/tmp

character_set_server                   = utf8
sql_mode                               = NO_ENGINE_SUBSTITUTION  # default "STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION
transaction_isolation                  = READ-COMMITTED    # default REPEATABLE-READ
explicit_defaults_for_timestamp        = 1     # default 0 
secure_file_priv                       =  

skip-symbolic-links
skip_name_resolve                      = 1
skip_external_locking                  = 1

performance_schema                     = 0      # default 1
autocommit                             = 1      # default 1
#event_scheduler                        = 1
lower_case_table_names                 = 1

## Cache
thread_cache_size                      = 192     # since 5.6.8 default -1, autosized ( max_connections / 100 ) + 8
table_open_cache                       = 4096
table_definition_cache                 = 4096
table_open_cache_instances             = 8
query_cache_type                       = 0
query_cache_size                       = 0
#query_cache_size                       = 32M
#query_cache_limit                      = 1M
#query_cache_min_res_unit               = 2K

## Per_thread Buffers
sort_buffer_size                       = 256M     # default 256K    
read_buffer_size                       = 64M     # default 256K
read_rnd_buffer_size                   = 64M     # default 256K
join_buffer_size                       = 128M    # default 256K 
bulk_insert_buffer_size                = 32M
thread_stack                           = 1M    # default 192K

## Temp Tables
tmp_table_size                         = 12G
max_heap_table_size                    = 12G

## Networking
back_log                               = 1000
max_connections                        = 1000
max_connect_errors                     = 1000000
interactive_timeout                    = 3600
wait_timeout                           = 3600
connect_timeout                        = 10
net_buffer_length                      = 1M
max_allowed_packet                     = 64M

## Sort
max_length_for_sort_data               = 8192    # default 1024
eq_range_index_dive_limit              = 200     # default 10

### Storage Engines
default_storage_engine                 = InnoDB
innodb                                 = FORCE

## MyISAM
key_buffer_size                        = 1G
myisam_sort_buffer_size                = 1G    # default 8M, for change index
myisam_max_sort_file_size              = 100G
myisam_repair_threads                  = 1
myisam_recover_options                 = default

## InnoDB
innodb_tmpdir                          = /opt/app/mysql57/tmp
innodb_file_per_table                  = 1
innodb_file_format                     = Barracuda
innodb_file_format_max                 = Barracuda
innodb_file_format_check               = ON
innodb_buffer_pool_size                = 4G
innodb_buffer_pool_chunk_size          = 128M
innodb_buffer_pool_instances           = 8        # since 5.6.6 if innodb_buffer_pool_size < 1G default 1 else 8
innodb_data_file_path                  = ibdata1:100M:autoextend
innodb_log_group_home_dir              = /opt/app/mysql57/redolog
innodb_log_file_size                   = 1G
innodb_log_files_in_group              = 3
innodb_log_buffer_size                 = 16M
innodb_undo_directory                  = /opt/app/mysql57/undolog
innodb_undo_logs                       = 128      # defautl 128
innodb_undo_tablespaces                = 4        # default 3
innodb_open_files                      = 4000
innodb_thread_concurrency              = 32
innodb_flush_log_at_trx_commit         = 2
innodb_flush_log_at_timeout            = 100       # defautl 1, when innodb_flush_log_at_trx_commit = 0 or 2
innodb_purge_threads                   = 4
innodb_large_prefix                    = 1       # default OFF, > 767 warning, else error unless use the DYNAMIC and COMPRESSED row formats up to 3072
innodb_print_all_deadlocks             = 1
innodb_max_dirty_pages_pct             = 70
innodb_lock_wait_timeout               = 50
innodb_flush_method                    = O_DIRECT
innodb_old_blocks_time                 = 1000     # since 5.6.6 default 1000
innodb_io_capacity                     = 600      # default 200
innodb_io_capacity_max                 = 2000     # default 2000
innodb_lru_scan_depth                  = 1024     # default 1024
innodb_read_io_threads                 = 8
innodb_write_io_threads                = 8
innodb_buffer_pool_load_at_startup     = 1
innodb_buffer_pool_dump_at_shutdown    = 1
innodb_buffer_pool_filename            = ib_buffer_pool  # default ib_buffer_pool
innodb_sort_buffer_size                = 64M       # default 1M , 64K - 64M , for change index

## Replication
server_id                              = 135102
log_bin                                = /opt/app/mysql57/binlog/bin-log
read_only                              = 1
log-slave-updates                      = 1
expire_logs_days                       = 3
binlog_format                          = ROW
binlog_row_image                       = noblob    # default full
#innodb_autoinc_lock_mode               = 2     # default 1
binlog_rows_query_log_events           = 1
max_binlog_size                        = 1G
binlog_cache_size                      = 16M
sync_binlog                            = 0

master_info_repository                 = TABLE
relay_log_info_repository              = TABLE

#relay_log                              = /opt/app/mysql57/relaylog/relay-log
#max_relay_log_size                     = 500M     # default 0, use max_binlog_size
#read_only                              = 1
#log_slave_updates                      = 1
#relay_log_purge                        = 1
#relay_log_recovery                     = 1
#skip_slave_start                       = 1
#slave_net_timeout                      = 60
#replicate_wild_do_table                = mysql.%
#replicate_wild_ignore_table            = test.%
#auto_increment_offset                  = 1
#auto_increment_increment               = 2
#plugin_dir                             = /opt/app/mysql57/lib/plugin
#plugin_load                            = "rpl_semi_sync_master=semisync_master.so;rpl_semi_sync_slave=semisync_slave.so"
#rpl_semi_sync_master_enabled           = 1
#rpl_semi_sync_slave_enabled            = 1
#rpl_semi_sync_master_timeout           = 1000

## Logging
log_output                             = FILE
#slow_query_log                         = 1
slow_query_log_file                    = /opt/app/mysql57/logs/slow.log
log_queries_not_using_indexes          = 0        # default 0
log_throttle_queries_not_using_indexes = 10       # default 0
min_examined_row_limit                 = 100      # default 0
log_slow_admin_statements              = 1
log_slow_slave_statements              = 1
long_query_time                        = 1
log_short_format                       = 0
log_error                              = /opt/app/mysql57/logs/error.log
log_warnings							= 2
#general_log                            = 1
#general_log_file                       = /opt/app/mysql57/logs/general.log

## Index
ft_min_word_len                        = 4

[mysqld_safe]
open_files_limit                       = 65535

[mysql]
no_auto_rehash
prompt                                 = "MySQL [\\d] > "

[mysqldump]
quick
max_allowed_packet                     = 32M

[myisamchk]
key_buffer_size                        = 64M
sort_buffer_size                       = 32M
read_buffer                            = 8M
write_buffer                           = 8M

[mysqlhotcopy]
interactive_timeout

[client]
socket                                 = /opt/app/mysql57/var/mysql.sock